homepage: http://github.com/thoughtbot/yesod-auth-oauth2
changelog-type: markdown
hash: 6e12dcdca4a665643412d01cd50df18337d25561405df3b7dfd4c798bc2c0d0d
test-bench-deps:
  base: ! '>=4.9.0.0 && <5'
  hspec: -any
  uri-bytestring: -any
  yesod-auth-oauth2: -any
maintainer: Pat Brisbin <pbrisbin@gmail.com>
synopsis: OAuth 2.0 authentication plugins
changelog: ! "## [*Unreleased*](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.6.0.0...master)\n\nNone\n\n##
  [v0.6.0.0](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.5.3.0...v0.6.0.0)\n\n-
  Remove deprecated Github module\n\n## [v0.5.3.0](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.5.2.0...v0.5.3.0)\n\n-
  Allow aeson-1.4 and hoauth2-1.8\n\n## [v0.5.2.0](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.5.1.0...v0.5.2.0)\n\n-
  `InvalidProfileResponse` was replaced with different, situation-specific\n  constructors;
  the exception type is considered internal API, but end-users may\n  see them in
  logs, or if they (unexpectedly) escape our error-handling\n- Errors during log-in
  no longer result in 4XX or 5XX responses; they now\n  redirect to `LoginR` with
  the exception details logged and something\n  user-appropriate displayed via `setMessage`\n\n##
  [v0.5.1.0](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.5.0.0...v0.5.1.0)\n\n-
  Added GitLab provider\n- Added properly-named `GitHub` module, deprecated `Github`\n-
  Store `refreshToken` in `credsExtra`\n\n## [v0.5.0.0](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.4.1.0...v0.5.0.0)\n\n-
  COMPATIBILITY: Allow and require yesod-1.6\n- COMPATIBILITY: Stop testing GHC 8.0
  on CI\n\n## [v0.4.1.0](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.4.0.1...v0.4.1.0)\n\n-
  Check for `error`s in callback query params, as described in the\n  [spec](https://tools.ietf.org/html/rfc6749#section-4.1.2.1)\n\n##
  [v0.4.0.1](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.4.0.0...v0.4.0.1)\n\n-
  COMPATIBILITY: Allow `http-types-0.12`\n\n## [v0.4.0.0](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.3.1...v0.4.0.0)\n\n-
  COMPATIBILITY: Allow `aeson-1.3`\n- COMPATIBILITY: Dropped a lot of information
  from `credsExtra`:\n\n  **TL;DR**: you'll no longer find things like `username`
  or `email` as keys in\n  the `credsExtra` map. Instead, you'll find the encoded
  profile response we\n  received and the OAuth access token. You can/should do your
  own decoding or\n  make your own follow-up requests to get extra data about your
  users.\n\n  This reduced a lot of complexity, likely duplication between our decoding
  and\n  yours, and (I think) makes the library easier to use.\n\n  - [Issue](https://github.com/thoughtbot/yesod-auth-oauth2/issues/71)\n
  \ - [PR](https://github.com/thoughtbot/yesod-auth-oauth2/pull/100)\n\n- COMPATIBILITY:
  Support GHC-8.2\n- COMPATIBILITY: Drop (claimed, but never tested) support for GHC-7.8
  & 7.10\n- LICENSE: fixed vague licensing (MIT now)\n\n## [v0.3.1](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.3.0...v0.3.1)\n\n-
  Internal project cleanup\n\n## [v0.3.0](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.2.4...v0.3.0)\n\n-
  COMPATIBILITY: Use `hoauth2-1.3`\n\n## [v0.2.4](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.2.1...v0.2.4)\n\n-
  FIX: Update Nylas provider\n- NEW: Battle.Net provider\n- NEW: Bitbucket provider\n-
  NEW: Salesforce provider\n\n## [v0.2.1](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.2.0...v0.2.1)\n\n-
  FIX: Fix collision in GitHub `email` / `public_email` extras value\n\n## [v0.2.0](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.1.10...v0.2.0)\n\n-
  NEW: Slack provider ([@jsteiner](https://github.com/thoughtbot/yesod-auth-oauth2/commit/aad8bd88eabf9fcf368d044e7003e5d323985837))\n\n##
  [v0.1.10](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.1.9...v0.1.10)\n\n-
  FIX: `location` is optional in GitHub response\n\n## [v0.1.9](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.1.8...v0.1.9)\n\n-
  COMPATIBILITY: Allow `transformers-0.5` ([@paul-rouse](https://github.com/thoughtbot/yesod-auth-oauth2/commit/120104b5348808f72877962c329a998434addace))\n\n##
  [v0.1.8](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.1.7...v0.1.8)\n\n-
  COMPATIBILITY: Allow `aeson-0.11` ([@k-bx](https://github.com/thoughtbot/yesod-auth-oauth2/commit/6e940b19e2d56080c7a749aeb29e143a17dad65c))\n\n##
  [v0.1.7](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.1.6...v0.1.7)\n\n-
  NEW: Prefer primary email in GitHub provider\n- NEW: Include `public_email` in GitHub
  extras response\n- REMOVED: Remove Twitter provider\n\n## [v0.1.6](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.1.5...v0.1.6)\n\n-
  NEW: Nicer error message on invalid `code` ([@silky](https://github.com/thoughtbot/yesod-auth-oauth2/commit/7354c36e1326d298e543fa65cf226153ed4a8a0b))\n\n##
  [v0.1.5](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.1.4...v0.1.5)\n\n-
  FIX: Incorrect `state` parameter handling\n\n## [v0.1.4](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.1.3...v0.1.4)\n\n-
  FIX: Use newer Nylas endpoint\n\n## [v0.1.3](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.1.2...v0.1.3)\n\n-
  NEW: EveOnline provider ([@Drezil](https://github.com/thoughtbot/yesod-auth-oauth2/pull/33))\n-
  NEW: Nylas provider ([@bts](https://github.com/thoughtbot/yesod-auth-oauth2/commit/815d44346403af0052a48aa844f506211bdc2863))\n\n##
  [v0.1.2](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.1.1...v0.1.2)\n\n-
  NEW: A more different Google provider ([@ssaavedra](https://github.com/thoughtbot/yesod-auth-oauth2/pull/32))\n\n##
  [v0.1.1](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.1.0...v0.1.1)\n\n-
  NEW: Twitter provider\n\n## [v0.1.0](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.12...v0.1.0)\n\n-
  REMOVED: Google provider, use `Yesod.Auth.GoogleEmail2`\n- CHANGED: Learn was renamed
  to Upcase\n- COMPATIBILITY: Drop support for GHC-6\n- COMPATIBILITY: Support GHC-7.10\n\n##
  [v0.0.12](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.11...v0.0.12)\n\n-
  COMPATIBILITY: Allow `transformers-0.4` ([@snoyberg](https://github.com/thoughtbot/yesod-auth-oauth2/pull/21))\n\n##
  [v0.0.11](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.10...v0.0.11)\n\n-
  COMPATIBILITY: Allow `aeson-0.8` ([@gfontenot](https://github.com/thoughtbot/yesod-auth-oauth2/pull/15))\n\n##
  [v0.0.10](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.9...v0.0.10)\n\n-
  COMPATIBILITY: Allow Yesod 1.4 ([@gregwebs](https://github.com/thoughtbot/yesod-auth-oauth2/pull/14))\n\n##
  [v0.0.9](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.8...v0.0.9)\n\n-
  NEW: Spotify ([@benekastah](https://github.com/thoughtbot/yesod-auth-oauth2/pull/13))\n\n##
  [v0.0.8](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.7...v0.0.8)\n\n-
  FIX: Username may be missing in GitHub responses ([@skade](https://github.com/thoughtbot/yesod-auth-oauth2/pull/12))\n\n##
  [v0.0.7](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.6...v0.0.7)\n\n-
  NEW: Scope support in GitHub provider ([@skade](https://github.com/thoughtbot/yesod-auth-oauth2/pull/11))\n\n##
  [v0.0.6](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.5.1...v0.0.6)\n\n-
  NEW: GitHub provider ([@freiric](https://github.com/thoughtbot/yesod-auth-oauth2/pull/10))\n-
  COMPATIBILITY: flag-driven `network`/`network-uri` dependency\n\n## [v0.0.5.1](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.5...v0.0.5.1)\n\n-
  DOCUMENTATION: fix data declaration, allows Haddocks to build\n\n## [v0.0.5](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.4...v0.0.5)\n\n-
  COMPATIBILITY: Allow `yesod-core-1.3` and target `yesod-auth-1.3` ([@maxcan](https://github.com/thoughtbot/yesod-auth-oauth2/pull/7))\n-
  COMPATIBILITY: Target `haouth2-0.4` ([@katyo](https://github.com/thoughtbot/yesod-auth-oauth2/pull/9))\n\n##
  [v0.0.4](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.3...v0.0.4)\n\n-
  COMPATIBILITY: Allow `text-1.*`\n- COMPATIBILITY: Allow `lifted-base-0.2.*`\n\n##
  [v0.0.3](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.2...v0.0.3)\n\n-
  FIX: replace `error` crash with `throwIO` exception\n\n## [v0.0.2](https://github.com/thoughtbot/yesod-auth-oauth2/compare/v0.0.1...v0.0.2)\n\n-
  Various documentation fixes.\n\n## [v0.0.1](https://github.com/thoughtbot/yesod-auth-oauth2/tree/v0.0.1)\n\nInitial
  version. Maintainer-ship taken over by\n[@pbrisbin](https://github.com/thoughtbot/yesod-auth-oauth2/pull/1).\n"
basic-deps:
  warp: -any
  http-client: ! '>=0.4.0 && <0.6'
  bytestring: ! '>=0.9.1.4'
  yesod-core: ! '>=1.6.0 && <1.7'
  base: ! '>=4.9.0.0 && <5'
  hoauth2: ! '>=1.3.0 && <1.9'
  aeson-pretty: -any
  text: ! '>=0.7 && <2.0'
  safe-exceptions: -any
  containers: -any
  uri-bytestring: -any
  yesod: -any
  random: -any
  errors: -any
  http-conduit: ! '>=2.0 && <3.0'
  load-env: -any
  http-types: ! '>=0.8 && <0.13'
  microlens: -any
  aeson: ! '>=0.6 && <1.5'
  yesod-auth: ! '>=1.6.0 && <1.7'
  yesod-auth-oauth2: -any
all-versions:
- '0.0.1'
- '0.0.2'
- '0.0.3'
- '0.0.4'
- '0.0.5'
- '0.0.5.1'
- '0.0.6'
- '0.0.7'
- '0.0.8'
- '0.0.9'
- '0.0.10'
- '0.0.11'
- '0.0.12'
- '0.1.0'
- '0.1.1'
- '0.1.2'
- '0.1.3'
- '0.1.4'
- '0.1.5'
- '0.1.6'
- '0.1.7'
- '0.1.8'
- '0.1.9'
- '0.1.10'
- '0.2.0'
- '0.2.1'
- '0.2.2'
- '0.2.4'
- '0.3.0'
- '0.3.1'
- '0.4.0.0'
- '0.4.0.1'
- '0.4.1.0'
- '0.5.0.0'
- '0.5.1.0'
- '0.5.2.0'
- '0.5.3.0'
- '0.6.0.0'
author: Tom Streller
latest: '0.6.0.0'
description-type: markdown
description: ! "# Yesod.Auth.OAuth2\n\nOAuth2 `AuthPlugin`s for Yesod.\n\n## Usage\n\n```hs\nimport
  Yesod.Auth\nimport Yesod.Auth.OAuth2.GitHub\n\ninstance YesodAuth App where\n    --
  ...\n\n    authPlugins _ = [oauth2GitHub clientId clientSecret]\n\nclientId :: Text\nclientId
  = \"...\"\n\nclientSecret :: Text\nclientSecret = \"...\"\n```\n\nSome plugins,
  such as GitHub and Slack, have scoped functions for requesting\nadditional information:\n\n```hs\noauth2SlackScoped
  [SlackBasicScope, SlackEmailScope] clientId clientSecret\n```\n\n## Working with
  Extra Data\n\nWe put the minimal amount of user data possible in `credsExtra` --
  just enough\nto support you parsing or fetching additional data yourself.\n\nFor
  example, if you work with GitHub and GitHub user profiles, you likely\nalready have
  a model and a way to parse the `/user` response. Rather than\nduplicate all that
  in our library, we try to make it easy for you to re-use that\ncode yourself:\n\n```hs\nauthenticate
  creds = do\n    let\n        -- You can run your own FromJSON parser on the response
  we already have\n        eGitHubUser :: Either String GitHubUser\n        eGitHubUser
  = getUserResponseJSON creds\n\n        -- Avert your eyes, simplified example\n
  \       Just accessToken = getAccessToken creds\n        Right githubUser = eGitHubUser\n\n
  \   -- Or make followup requests using our access token\n    runGitHub accessToken
  $ userRepositories githubUser\n\n    -- Or store it for later\n    insert User\n
  \       { userIdent = credsIdent creds\n        , userAccessToken = accessToken\n
  \       }\n```\n\n**NOTE**: Avoid looking up values in `credsExtra` yourself; prefer
  the provided\n`get` functions. The data representation itself is no longer considered
  public\nAPI.\n\n## Local Providers\n\nIf we don't supply a \"Provider\" (e.g. GitHub,
  Google, etc) you need, you can\nwrite your own using our provided `Prelude`:\n\n```haskell\nimport
  Yesod.Auth.OAuth2.Prelude\n\npluginName :: Text\npluginName = \"mysite\"\n\noauth2MySite
  :: YesodAuth m => Text -> Text -> AuthPlugin m\noauth2MySite clientId clientSecret
  =\n    authOAuth2 pluginName oauth2 $ \\manager token -> do\n        -- Fetch a
  profile using the manager and token, leave it a ByteString\n        userResponse
  <- -- ...\n\n        -- Parse it to your preferred identifier, e.g. with Data.Aeson\n
  \       userId <- -- ...\n\n        -- See authGetProfile for the typical case\n\n
  \       pure Creds\n            { credsPlugin = pluginName\n            , credsIdent
  = userId\n            , credsExtra = setExtra token userResponse\n            }\n
  \ where\n    oauth2 = OAuth2\n        { oauthClientId = clientId\n        , oauthClientSecret
  = clientSecret\n        , oauthOAuthorizeEndpoint = \"https://mysite.com/oauth/authorize\"\n
  \       , oauthAccessTokenEndpoint = \"https://mysite.com/oauth/token\"\n        ,
  oauthCallback = Nothing\n        }\n```\n\nThe `Prelude` module is considered public
  API, though we may build something\nhigher-level that is more convenient for this
  use-case in the future.\n\n## Development & Tests\n\n```console\nstack setup\nstack
  build --dependencies-only\nstack build --pedantic --test\n```\n\nPlease also run
  HLint and Weeder before submitting PRs.\n\n---\n\n[CHANGELOG](./CHANGELOG.md) |
  [LICENSE](./LICENSE)\n"
license-name: MIT
