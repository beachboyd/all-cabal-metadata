homepage: https://github.com/Franciman/vabal
changelog-type: markdown
hash: 0eb4ce11eb746a3daa4dc72057ead536a21f0e1beec76c9c5ee9f14f6c3001a5
test-bench-deps:
  bytestring: -any
  unix: ! '>=2.7.2 && <2.8'
  Cabal: -any
  base: -any
  filepath: -any
  process: -any
  tar: ! '>=0.5.1 && <0.6'
  vabal-internal: -any
  deepseq: ! '>=1.4.3 && <1.4.5'
  directory: -any
maintainer: franciman12@gmail.com
synopsis: the cabal companion
changelog: ! '# Revision history for vabal


  ## 1.0.0 -- 2018-12-26


  * First version. Released on an unsuspecting world.

'
basic-deps:
  bytestring: ! '>=0.10.8 && <0.11'
  Cabal: ! '>=2.4 && <2.5'
  base: ! '>=4.11 && <4.13'
  filepath: ! '>=1.4.2 && <1.5'
  process: ! '>=1.6.3 && <1.7'
  cassava: ! '>=0.5.1 && <0.6'
  vabal-internal: -any
  optparse-applicative: ! '>=0.14.3 && <0.15'
  directory: ! '>=1.3.3 && <1.4'
all-versions:
- 1.0.0
author: Francesco Magliocca
latest: 1.0.0
description-type: markdown
description: ! "# Vabal - The Cabal Companion\n\n\n What is it?\n------------\n\nHave
  you ever wanted to try the new bleeding-edge GHC release, but also need older GHCs
  for your projects or programs (XMonad!)?\n\nHave you ever upgraded GHC just to find
  all your haskell projects broken?\n\nHave you ever dreamt about treating `base`
  as all other packages (i.e. change its version without much thought)?\n\n`vabal`
  tries to determine a `ghc` version that complies with the `base` package constraints
  found in the `.cabal` file.\nThen it uses [ghcup](https://github.com/haskell/ghcup)
  to fetch the compiler (if you don't have it yet)\nand prints to stdout the options
  to pass to `cabal` to use the fetched compiler.\n\nBy default `vabal` tries to use
  compilers already available on the system\nand downloads them only when it can't
  do otherwise (or fails if you use the `--no-install` flag).\n\nThis program tries
  to solve these issues in the easiest possible way.\nThe GHC compiler downloading
  is managed by [ghcup](https://github.com/haskell/ghcup).\nNo need to manually manage
  different ghc versions by hand!\n\n`vabal` tries to be as little intrusive as possible,
  leverages `cabal`'s capabilities of working with different GHC versions,\nand does
  *not* force you in its paradigm.\nThe only change to the global system state `vabal`
  does is to tell `ghcup` to download a compiler,\nthis behavior can be disabled with
  `--no-install` flag, so you are always in charge of what's happening!\n\n\n How
  to install it\n-------------------\n\nIn order to install `vabal` you need:\n- `ghc`
  >= 8.4.1,\n- `cabal` >= 2.4.0.0 (Actually you just need >= 2.0.0.0 to install it)\n\nTo
  install it from sources, you can run:\n> $ cabal v2-install vabal\n\ninside the
  vabal directory.\n(Remember to put `$HOME/.cabal/bin` in your `PATH`)\n\nOr you
  can install `vabal` from Hackage by running:\n> $ cabal v2-install vabal\n\n\n Requirements\n--------------\n\nThese
  programs are required to be in `PATH`:\n- ghcup\n- cabal >= 2.4.0.0\n\n\n Quick
  start\n--------------\n\nFor starters run:\n> $ vabal update\n\nThis will download
  updated infos about released `ghc`s and the versions of `base` they ship,\nthe info
  is stored [here](https://github.com/Franciman/vabal-ghc-metadata/blob/master/ghc-metadata.csv),\nand
  will put them in `$HOME/.vabal/ghc-metadata.csv`.\nYou may want to run this from
  time to time, when new `ghc`s get released, so that vabal will know about them.\n\nThen
  cd into your project directory and run:\n> $ vabal configure\n\nThis will analyze
  the cabal file in the directory and extract constraints imposed on `base`,\nthen
  it will get a compatible version of `ghc` using `ghcup` (possibly downloading it)\nand
  will finally run `cabal v2-configure` to configure the project with the obtained
  version of `ghc`.\n\nIf everything went fine, you now have your project configured
  to use a `ghc` compatible\nwith the constraints imposed on `base`, you can now build
  your project as you're used to:\n> $ cabal v2-build\n\nYou can also enable and disable
  flags for your package, like this:\n> $ vabal configure --flags=\"flag1 -flagToDisable\"\n\nAnd
  if you want to pass other flags directly to `cabal v2-configure`,\nyou can do it
  after a `--`, e.g.:\n> $ vabal configure -- --enable-tests --enable-shared\n\n\nHow
  to use vabal: full story\n----------------------------\n\n`vabal` tries to leverage
  the power of composability of shell commands,\nyou can use it in combination with
  any `cabal` subcommand.\nFor example, if you don't want vabal to also perform the
  `cabal v2-configure` step,\nbut would like to use it in combination with `cabal
  v2-build`, you can run (*):\n> $ vabal --flags=\"your -flags\" | xargs -r cabal
  v2-build\n\n(If you are on `OS X`, you don't need to specify the -r option for xargs)\n\nxargs
  invokes cabal with the arguments and options specified *plus* options read from
  stdin.\nRead the *Remark* for info about the `-r` option.\n\n> In Haskell jargon,
  you can see this as partially applying the `cabal` \"function\" first,\n> and then
  providing it the remaining arguments that `vabal` emitted.\n\nWhat vabal actually
  does is analyze the cabal file, obtain a suitable `ghc`, using `ghcup`, and then
  print to stdout\noptions to pass to cabal (already properly escaped to be used with
  xargs).\nIt follows the Unix philosophy and its power comes from composition with
  other programs.\n\nIn fact, `vabal configure` is just a shortcut for:\n> vabal |
  xargs -r cabal v2-configure\n\n(*) Remark: \n> The `-r` flag you see is only available
  in the GNU version of `xargs`. It makes xargs fail if its input is empty,\n> i.e.
  when vabal fails. This is necessary or cabal will run as well without arguments
  from vabal.\n> If you use the BSD version of `xargs`, then this flag is not necessary
  (and is neither available),\n> because this is the default behavior.\n> Another
  possibility is to use the `-p` flag for `xargs` which is available on all `POSIX`
  systems,\n> it will show the command it is about to run and ask the user if he wants
  to proceed. In this way,\n> if vabal failed, he can stop the execution.\n> \n> Consult
  your system's manpage for `xargs` for further info.\n\n\n Gotchas\n----------\n\nHere
  are some known gotchas that affect `vabal`:\n- `vabal` trusts the constraints imposed
  on `base` that it finds in the cabal file,\ntherefore it only finds a ghc version
  that makes it possible to respect the constraints,\nbut it is not guaranteed that
  the build will be successful. (Generally one should always write correct constraints)\n\n\n
  Full list of options\n---------------------\n\n`vabal` and `vabal configure` accept
  these options:\n\n```\n  -g,--with-ghc-version VER\n                           Explicitly
  tell which version of ghc you want to use\n                           for the project.
  (Incompatible with option\n                           --with-base-version)\n                           \n
  \ -b,--with-base-version VER\n                           Specify the version of
  base package you want to use.\n                           It is going to be checked
  against base constraints in\n                           the cabal file for validity.
  (Incompatible with\n                           option --with-ghc-version)\n                           \n
  \ --flags FLAGS            String containing a list of space separated flags to\n
  \                          be used to configure the project (You can enable or\n
  \                          disable a flag by adding a + or - in front of the\n                           flag
  name. When none is specified, the flag is\n                           enabled).
  Flag assignment determined here is also\n                           emitted to stdout
  as a cabal option\n                           (or passed to \"cabal v2-configure\"
  in the case of\n                           \"vabal configure\")\n                           \n
  \ --cabal-file FILE        Explicitly tell which cabal file to use. This option\n
  \                          also emitted to stdout as cabal option (or passed to\n
  \                          `cabal v2-configure` in the case of \"vabal configure\")\n
  \ \n  --no-install             If GHC needs to be downloaded, fail, instead.\n  \n
  \ --always-newest          Always choose newest GHC possible, don't prefer\n                           already
  installed GHCs\n```\n\nwith `vabal configure` you can also pass arguments directly
  to cabal,\njust specify them after `--`, e.g.\n> vabal configure -- --cabal-option
  --enable-tests --haddock-css=PATH\n\n\n How to uninstall it\n--------------------\n\nIf
  you want to uninstall `vabal` you can follow the same steps\nthat are necessary
  to uninstall any executable installed with `cabal v2-install`\n(i.e. remove the
  symlink in \"$HOME/.cabal/bin\").\n\nFurthermore, you also need to remove the `$HOME/.vabal`
  directory\ncontaining metadata used by `vabal`.\n\n\n Contributing\n--------------\n\nPull
  Requests and suggestions are welcome.\n\n\n Issues\n--------\n\nYou can signal issues
  [here](https://github.com/Franciman/vabal/issues)\n\n\n Contributors\n--------------\n\nFrancesco
  Ariis\n\nFrancesco Gazzetta\n\nFrancesco Magliocca\n\nLorenzo Tabacchini\n\nMarco
  Umbrello\n\n"
license-name: GPL-3.0-only
